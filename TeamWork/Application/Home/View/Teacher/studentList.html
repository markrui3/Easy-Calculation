<include file="Index/header"/>
<js href="__PUBLIC__/assets/js/jquery.dataTables.min.js"/>
<css href="__PUBLIC__/assets/css/jquery.dataTables.min.css"/>
<style>
    .list-title {
      text-align: center;
      padding: 30px;
    }
</style>
<body>
    <header class="am-topbar am-topbar-fixed-top">
        <div class="am-container">
            <h1 class="am-topbar-brand">教师模块 </h1>
            <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-secondary am-show-sm-only" data-am-collapse="{target: '#collapse-head'}">
                <span class="am-sr-only">导航切换</span>
                <span class="am-icon-bars"></span>
            </button>
            <div class="am-collapse am-topbar-collapse" id="collapse-head">
                <ul class="am-nav am-nav-pills am-topbar-nav">
                    <li><a href="#">首页</a></li>
                    <li class="am-active"><a href="#">学生</a></li>
                    <li><a href="#">习题</a></li>
                    <li><a href="#">考试</a></li>
                </ul>

                <if condition="session('teacher')">
                    <div class="am-topbar-right">
                        <button class="am-btn am-btn-secondary am-topbar-btn am-btn-sm">
                            <span class="am-icon-user"></span>
                            <a href="#"> {:I('session.teacher')['username']}</a>
                        </button>
                    </div>
                <else />
                    <div class="am-topbar-right">
                        <button class="am-btn am-btn-secondary am-topbar-btn am-btn-sm">
                            <span class="am-icon-pencil"></span>
                            <a href="{:U("/Home/Teacher/login")}"> 登录</a>
                        </button>
                    </div>
                </if>
            </div>
        </div>
    </header>
    <div class="list-title">
        <h1>学生信息列表</h1>
    </div>
    <div class="am-g am-u-lg-centered">
        <table id="studentList" class="stripe">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>AverageScore</th>
                    <th>DetailInfo</th>
                </tr>
            </thead>
        </table>
    </div>
</body>

<script type="text/javascript">
    $(document).ready(function($) {

        $.ajax({
            url: '{:U("/Home/Teacher/getStudentList")}',
            type: 'POST',
            dataType: 'json',
            data: {
                teacher_id: '{:I("session.teacher")["teacher_id"]}'
            }
        })
            .done(function(response) {
                console.log(response);
                $('#studentList').DataTable( {
                    data: response,
                    columns: [
                        { data: 'student_id' },
                        { data: 'name' },
                        { data: 'avescore' },
                        { data: 'info' }
                    ]
                } );
            })
            .fail(function() {
                console.log("error");
            })
            .always(function() {
                console.log("complete");
            });
    });
</script>
